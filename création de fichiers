# En R 
# Transformation du tableau en fichiers 
library("readxl") # Package permettant de lire les excels 
library("tidyr") # Package permettant d'acceder à dplyr
library ("dplyr") # Package permettant de remanier le jeu de données 
library(plyr)

# Chargement des tableaux 
donnees_lab <- read_excel ("Scalaflux_labelling.xlsx") # tableau avec M0 et M1
donnees_poo <- read_excel ("Scalaflux_poolsize.xlsx") " tableau avec les pools size

#GLUVAL miso 

donnes_glu_val <- donnees_lab %>%
  select(time , starts_with("Val"))%>%
  pivot_longer(cols = c("Val_M1" , "Val_M0") , names_to = "Species_Isospecies" , values_to = "Value") %>%
  separate ( col = "Species_Isospecies" , into = c("Specie" , "Isospecies" ) , sep = "_") %>%
  mutate ( ID = "", Comments = "" , Fragments = 1 , Dataset = "MS-1" , SD = max(Value , Specie != "M0")/10)
# Sélection des colonnes d'interet dans notre cas la valine et le temps. Transformation des colonnes M1 et M0 en lignes. 
# Creation de colonnes soit a partir d existante soit avec une valeur qui est défini selon l'expérience 

donnes_glu_val <- donnes_glu_val[, c("ID" , "Comments" , "Specie", "Fragments", "Dataset" , "Isospecies" , "Value" , "SD" , "time" )]
# Organisation des colonnes conforme au fichier puis création du fichier
write.table(donnes_glu_val, file="Valine.miso", sep="\t") 

# #GLUVAL interpolation lineaire.tsv  

donnees_glu_val_i <- donnees_lab %>%
  select(time , starts_with("Glu"))
# Sélection des colonnes d interets

colnames(donnees_glu_val_i) <- c("Time", "M1", "M0")
donnees_glu_val_i <- donnees_glu_val_i[, c("Time", "M0", "M1"  )]
# Organisation des colonnes conforme au fichier puis création du fichier
write.table(donnees_glu_val_i, file="Valine.tsv", sep="\t")
